<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Argus Terminal</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="icon" type="image/png" sizes="32x32" href="data:image/png;base64,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">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Fira Code', 'Courier New', monospace;
        }

        body {
            background: linear-gradient(135deg, #0c0c0c, #1a1a1a, #0c0c0c);
            height: 100vh;
            display: flex;
            flex-direction: column;
            color: #e0e0e0;
            overflow: hidden;
            position: relative;
        }

        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background:
                    radial-gradient(circle at 20% 30%, rgba(0, 255, 200, 0.03) 0%, transparent 25%),
                    radial-gradient(circle at 80% 70%, rgba(100, 100, 255, 0.03) 0%, transparent 25%);
            pointer-events: none;
            z-index: -1;
        }

        .terminal-header {
            background: rgba(20, 20, 20, 0.95);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            padding: 8px 12px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 1px solid rgba(60, 200, 150, 0.3);
            flex-shrink: 0;
            box-shadow: 0 2px 15px rgba(0, 255, 200, 0.1);
            border-radius: 8px 8px 0 0;
            margin: 10px 10px 0 10px;
            border: 1px solid rgba(60, 200, 150, 0.2);
        }

        .terminal-title {
            font-weight: 500;
            color: #00ffc8;
            font-size: 14px;
            letter-spacing: 0.5px;
            text-shadow: 0 0 5px rgba(0, 255, 200, 0.5);
            font-weight: 600;
        }

        .terminal-controls {
            display: flex;
        }

        .control {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            margin-left: 8px;
            cursor: pointer;
            transition: all 0.2s ease;
            box-shadow: 0 0 8px rgba(255, 255, 255, 0.3);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .close {
            background-color: #ff5f56;
            box-shadow: 0 0 8px rgba(255, 95, 86, 0.6);
        }
        .minimize {
            background-color: #ffbd2e;
            box-shadow: 0 0 8px rgba(255, 189, 46, 0.6);
        }
        .maximize {
            background-color: #27c93f;
            box-shadow: 0 0 8px rgba(39, 201, 63, 0.6);
        }

        .control:hover {
            transform: scale(1.1);
            box-shadow: 0 0 12px rgba(255, 255, 255, 0.6);
        }

        .terminal-body {
            flex: 1;
            display: flex;
            flex-direction: column;
            overflow: hidden;
            padding: 10px;
            background: rgba(10, 10, 10, 0.8);
            border: 1px solid rgba(60, 200, 150, 0.2);
            border-radius: 0 0 8px 8px;
            margin: 0 10px 0 10px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
        }

        .login-container {
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            height: 100%;
            padding: 20px;
            text-align: center;
            background: rgba(20, 20, 20, 0.7);
            border-radius: 8px;
            border: 1px solid rgba(60, 200, 150, 0.2);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
        }

        .login-title {
            color: #00ffc8;
            margin-bottom: 24px;
            font-size: 22px;
            font-weight: 300;
            letter-spacing: 2px;
            text-shadow: 0 0 10px rgba(0, 255, 200, 0.5);
            background: linear-gradient(90deg, #00ffc8, #00b8ff);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .login-form {
            background: rgba(30, 30, 30, 0.8);
            padding: 24px;
            border: 1px solid rgba(60, 200, 150, 0.3);
            border-radius: 8px;
            width: 100%;
            max-width: 380px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3), 0 0 15px rgba(0, 255, 200, 0.1);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
        }

        .input-group {
            margin-bottom: 18px;
            text-align: left;
        }

        .input-label {
            display: block;
            margin-bottom: 6px;
            color: #00ffc8;
            font-size: 14px;
            font-weight: 500;
            text-shadow: 0 0 5px rgba(0, 255, 200, 0.3);
        }

        .input-field {
            width: 100%;
            padding: 12px;
            background: rgba(20, 20, 20, 0.8);
            border: 1px solid rgba(60, 200, 150, 0.5);
            color: #00ffc8;
            font-size: 14px;
            border-radius: 6px;
            transition: all 0.3s ease;
            box-shadow: 0 0 10px rgba(0, 255, 200, 0.1);
            backdrop-filter: blur(5px);
            -webkit-backdrop-filter: blur(5px);
        }

        .input-field:focus {
            outline: none;
            border-color: #00ffc8;
            box-shadow: 0 0 15px rgba(0, 255, 200, 0.3);
            transform: translateY(-1px);
        }

        .btn {
            background: rgba(0, 255, 200, 0.1);
            color: #00ffc8;
            border: 1px solid rgba(0, 255, 200, 0.5);
            padding: 12px 16px;
            cursor: pointer;
            font-weight: 500;
            width: 100%;
            font-size: 14px;
            border-radius: 6px;
            transition: all 0.3s ease;
            box-shadow: 0 0 15px rgba(0, 255, 200, 0.1);
            text-shadow: 0 0 5px rgba(0, 255, 200, 0.5);
        }

        .btn:hover {
            background: rgba(0, 255, 200, 0.2);
            transform: translateY(-2px);
            box-shadow: 0 5px 20px rgba(0, 255, 200, 0.2);
        }

        .btn:disabled {
            background: rgba(60, 60, 60, 0.5);
            color: #333;
            border-color: #4d4d4d;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }

        .terminal-content {
            display: flex;
            flex-direction: column;
            height: 100%;
            padding: 12px;
            overflow: hidden;
            background: #3B3F41;
            border-radius: 8px;
            border: 1px solid rgba(60, 200, 150, 0.2);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
        }

        .output-container {
            flex: 1;
            overflow-y: auto;
            padding-right: 5px;
            padding: 10px;
            background: rgba(20, 20, 20, 0.5);
            border-radius: 6px;
            border: 1px solid rgba(60, 200, 150, 0.2);
            cursor: text;
        }

        .output-container::-webkit-scrollbar {
            width: 8px;
        }

        .output-container::-webkit-scrollbar-track {
            background: rgba(20, 20, 20, 0.8);
            border-radius: 4px;
        }

        .output-container::-webkit-scrollbar-thumb {
            background: linear-gradient(180deg, #00ffc8, #00b8ff);
            border-radius: 4px;
            border: 1px solid rgba(0, 255, 200, 0.3);
        }

        .output-container::-webkit-scrollbar-thumb:hover {
            background: linear-gradient(180deg, #00b8ff, #00ffc8);
        }

        .output {
            margin-bottom: 10px;
            line-height: 1.4;
            white-space: pre-wrap;
            font-size: 14px;
        }

        .output.error {
            color: #ff5f56 !important;
        }

        .output.success {
            color: #00ffc8 !important;
            font-weight: 500;
        }

        .command-line {
            display: flex;
            align-items: center;
            margin-bottom: 10px;
        }

        .prompt {
            color: #00ffc8;
            margin-right: 8px;
            white-space: nowrap;
            font-size: 14px;
            font-weight: 600;
            text-shadow: 0 0 5px rgba(0, 255, 200, 0.3);
            font-family: 'Fira Code', 'Courier New', monospace;
            letter-spacing: 0.5px;
            cursor: text;
        }

        .input-line {
            flex-grow: 1;
            display: flex;
            align-items: center;
        }

        .command-input-wrapper {
            position: relative;
            display: inline-flex;
            align-items: center;
            flex-grow: 1;
        }

        .command-input {
            font-family: 'Fira Code', 'Courier New', monospace;
            font-size: 14px;
            line-height: 1;
            white-space: nowrap;
            overflow: visible;
            letter-spacing: 0;
            padding: 0;
            margin: 0;
            border: none;
            background: transparent;
            color: #e0e0e0;
            width: 100%;
            outline: none;
            height: 18px;
            min-height: 18px;
            max-height: 18px;
            flex-shrink: 0;
        }

        .response {
            color: #A6B8C8;
        }

        .warn {
            color: #bb8240;
        }

        .command {
            color: #A6B8C8;
        }

        .terminal-footer {
            padding: 8px 12px;
            background: rgba(20, 20, 20, 0.95);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            border-top: 1px solid rgba(45, 217, 155, 0.3);
            display: flex;
            justify-content: space-between;
            font-size: 14px;
            flex-shrink: 0;
            box-shadow: 0 -2px 15px rgba(0, 0, 0, 0.3);
            border-radius: 0 0 8px 8px;
            margin: 0 10px 10px 10px;
            border: 1px solid rgba(60, 200, 150, 0.2);
        }

        .connection-status {
            display: flex;
            align-items: center;
        }

        .status-indicator {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            margin-right: 6px;
            box-shadow: 0 0 8px rgba(255, 255, 255, 0.3);
        }

        .connected {
            background-color: #00ffc8;
            box-shadow: 0 0 8px rgba(0, 255, 200, 0.6);
            animation: pulse 1.5s infinite;
        }

        .disconnected {
            background-color: #ff5f56;
            box-shadow: 0 0 8px rgba(255, 95, 86, 0.6);
        }

        .connecting {
            background-color: #ffbd2e;
            box-shadow: 0 0 8px rgba(255, 189, 46, 0.6);
            animation: pulse 1.5s infinite;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; transform: scale(1); }
            50% { opacity: 0.7; transform: scale(1.1); }
        }

        .token-info {
            display: flex;
            align-items: center;
            margin-left: 12px;
        }

        .token-expiry {
            margin-left: 5px;
            color: #00ffc8;
            text-shadow: 0 0 5px rgba(0, 255, 200, 0.3);
        }

        .loading {
            display: inline-block;
            width: 14px;
            height: 14px;
            border: 2px solid rgba(0, 255, 200, 0.3);
            border-radius: 50%;
            border-top-color: #00ffc8;
            animation: spin 1s ease-in-out infinite;
            margin-right: 6px;
            box-shadow: 0 0 8px rgba(0, 255, 200, 0.2);
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        .login-message {
            margin-top: 15px;
            font-size: 14px;
            text-align: center;
            padding: 8px;
            border-radius: 4px;
            background: rgba(0, 0, 0, 0.3);
            border: 1px solid rgba(60, 200, 150, 0.2);
        }

        .output-container::after {
            content: '';
            display: block;
            height: 20px;
        }

        @media (max-width: 768px) {
            .terminal-header {
                padding: 6px 10px;
            }

            .login-form {
                padding: 18px;
            }

            .login-title {
                font-size: 20px;
            }

            .terminal-footer {
                flex-direction: column;
                gap: 8px;
            }

            .terminal-body {
                margin: 0 5px 0 5px;
            }

            .terminal-header,
            .terminal-footer {
                margin: 5px;
            }
        }
        /* 在样式部分添加以下代码 */
        .copy-button-container {
            position: relative;
            display: inline-block;
        }

        .copy-button {
            display: none;
            position: absolute;
            right: -70px;
            top: 50%;
            transform: translateY(-50%);
            padding: 2px 6px;
            font-size: 0.85em;
            background: rgba(0, 255, 200, 0.1);
            color: #00ffc8;
            border: 1px solid rgba(0, 255, 200, 0.1);
            border-radius: 4px;
            cursor: pointer;
            opacity: 0.9;
            transition: all 0.2s ease;
            z-index: 10;
            white-space: nowrap;
        }

        .copy-button:hover {
            background: rgba(0, 255, 200, 0.2);
            box-shadow: 0 0 8px rgba(0, 255, 200, 0.3);
        }

        .copy-content {
            display: inline;
            color: #00ffc8;
            font-weight: 500;
            background: rgba(0, 255, 200, 0.1);
            padding: 2px 4px;
            border-radius: 4px;
            margin: 0 2px;
            border: 1px solid rgba(0, 255, 200, 0.1);
            white-space: pre;
            line-height: 1.4;
        }

        .copy-button-container:hover .copy-button {
            display: block;
        }

        .copy-button-container:hover .copy-content {
            background: rgba(0, 255, 200, 0.2);
            box-shadow: 0 0 8px rgba(0, 255, 200, 0.3);
        }
        .login-message.error {
            color: #ff5f56 !important; /* 红色文字 */
            background: rgba(255, 95, 86, 0.1); /* 淡红背景 */
            border-color: rgba(255, 95, 86, 0.3);
            text-shadow: 0 0 5px rgba(255, 95, 86, 0.2);
        }
    </style>
</head>
<body>
<div class="terminal-header">
    <div class="terminal-title">Argus Terminal <span class="version">v1.0</span></div>
    <div class="terminal-controls">
        <!-- Controls hidden -->
    </div>
</div>

<div class="terminal-body" id="terminalBody">
    <div class="login-container" id="loginContainer">
        <h1 class="login-title">ARGUS TERMINAL</h1>
        <div class="login-form">
            <div class="input-group">
                <label class="input-label">用户名</label>
                <input type="text" class="input-field" id="username" placeholder="输入用户名" value="">
            </div>
            <div class="input-group">
                <label class="input-label">密码</label>
                <input type="password" class="input-field" id="password" placeholder="输入密码" value="">
            </div>
            <button class="btn" id="loginBtn">
                <span id="loginText">登录</span>
                <span id="loginSpinner" class="loading" style="display: none;"></span>
            </button>
            <div id="loginMessage" class="login-message"></div>
        </div>
    </div>

    <div id="terminalOutput" class="terminal-content" style="display: none;">
        <div class="output-container" id="outputContainer">
            <div class="output" id="commandHistory"></div>

            <div class="command-line">
                <span class="prompt">
                    <span class="user-host">argus@${currentUser}</span> %
                </span>
                <div class="input-line">
                    <div class="command-input-wrapper">
                        <input type="text" class="command-input" id="commandInput" autocomplete="off">
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<div class="terminal-footer">
    <div style="display: flex; align-items: center;">
        <div class="connection-status">
            <div class="status-indicator disconnected" id="statusIndicator"></div>
            <span id="statusText">未连接</span>
        </div>
        <div class="token-info" id="tokenInfo" style="display: none;">
            <i class="fas fa-key"></i>
            <span class="token-expiry" id="tokenExpiry"></span>
        </div>
    </div>
</div>

<script>
    let authToken = null;
    let tokenExpiry = null;
    let tokenTimer = null;
    let tokenInterval = null;
    let isConnected = false;
    let currentUser = '';
    let commandIndex = -1;
    let commands = [];
    let websocket = null;
    let isReconnecting = false;
    let reconnectAttempts = 0;
    const MAX_RECONNECT_ATTEMPTS = 5;
    const BASE_RECONNECT_DELAY = 2000;
    let cachedPublicKey = null; // 用于缓存已解析的公钥对象

    function getContextPath() {
        const fullPath = window.location.pathname;
        const terminalIndex = fullPath.indexOf('/argus/index.html');
        return terminalIndex > 0 ? fullPath.substring(0, terminalIndex) : '';
    }

    function getWebSocketUrl() {
        const protocol = window.location.protocol === 'https:' ? 'wss:' : 'ws:';
        const host = window.location.host;
        const contextPath = getContextPath();
        return `${protocol}//${host}${contextPath}/argus-ws`;
    }

    function scrollToBottom() {
        const outputContainer = document.getElementById('outputContainer');
        outputContainer.scrollTop = outputContainer.scrollHeight;
    }

    document.addEventListener('DOMContentLoaded', function() {
        const loginContainer = document.getElementById('loginContainer');
        const terminalOutput = document.getElementById('terminalOutput');
        const usernameInput = document.getElementById('username');
        const passwordInput = document.getElementById('password');
        const loginBtn = document.getElementById('loginBtn');
        const loginText = document.getElementById('loginText');
        const loginSpinner = document.getElementById('loginSpinner');
        const loginMessage = document.getElementById('loginMessage');
        const commandHistory = document.getElementById('commandHistory');
        const userHost = document.querySelector('.user-host');
        const statusIndicator = document.getElementById('statusIndicator');
        const statusText = document.getElementById('statusText');
        const tokenInfo = document.getElementById('tokenInfo');
        const tokenExpiryElement = document.getElementById('tokenExpiry');

        checkExistingToken();

        // 确保公钥加载完成后再绑定事件
        fetchAndStorePublicKey()
            .then(() => {
                // 公钥加载成功后，再绑定登录事件
                loginBtn.addEventListener('click', handleLogin);
                passwordInput.addEventListener('keypress', function(e) {
                    if (e.key === 'Enter') handleLogin();
                });
            })
            .catch(err => {
                showLoginMessage('公钥获取失败', 'error');
                // 禁用登录按钮
                loginBtn.disabled = true;
            });

        function checkExistingToken() {
            const token = localStorage.getItem('argus-token');
            const expiry = localStorage.getItem('argus-token-expiry');
            if (token && expiry) {
                const expiryTime = parseInt(expiry);
                const currentTime = new Date().getTime();
                if (currentTime < expiryTime) {
                    authToken = token;
                    startTokenTimer(expiryTime - currentTime);
                    showTerminal();
                    connectWebSocket();

                    const tokenInfo = document.getElementById('tokenInfo');
                    const tokenExpiryElement = document.getElementById('tokenExpiry');
                    tokenInfo.style.display = 'flex';
                    updateTokenExpiryDisplay(expiryTime);  // 注意：传入的是绝对时间戳

                    // 恢复用户名
                    const storedUsername = localStorage.getItem('argus-username');
                    if (storedUsername) {
                        currentUser = storedUsername;
                        const userHost = document.querySelector('.user-host');
                        if (userHost) userHost.textContent = `argus@${currentUser}`;
                    }
                } else {
                    localStorage.removeItem('argus-token');
                    localStorage.removeItem('argus-token-expiry');
                    localStorage.removeItem('argus-username');
                }
            }
        }


        // 兼容HTTP和HTTPS的加密方案
        async function importPublicKey(base64Key) {
            try {

                // 获取可用的crypto API
                const crypto = window.crypto || window.msCrypto;
                if (!crypto) {
                    throw new Error('Crypto API不可用');
                }

                // 尝试获取subtle方法
                let subtle = null;

                // 在HTTP环境下，某些浏览器可能限制crypto.subtle访问
                // 尝试多种方式获取subtle
                if (crypto.subtle) {
                    subtle = crypto.subtle;
                } else if (crypto.webkitSubtle) {
                    subtle = crypto.webkitSubtle;
                } else if (window.isSecureContext === false) {
                    // 在非安全上下文（HTTP）中，尝试直接访问
                    // 注意：这可能在部分浏览器中失败
                    try {
                        subtle = crypto.subtle;
                    } catch (e) {
                        console.warn('直接访问crypto.subtle失败:', e);
                    }
                }

                if (!subtle) {
                    throw new Error('无法访问加密功能，请使用HTTPS或现代浏览器');
                }

                // 清理可能的空白字符
                const cleanBase64 = base64Key.replace(/\s+/g, '');

                // Base64解码
                const binaryString = atob(cleanBase64);
                const bytes = new Uint8Array(binaryString.length);
                for (let i = 0; i < binaryString.length; i++) {
                    bytes[i] = binaryString.charCodeAt(i);
                }

                // 使用RSA-OAEP算法
                const cryptoKey = await subtle.importKey(
                    "spki",
                    bytes,
                    {
                        name: "RSA-OAEP",
                        hash: { name: "SHA-256" }
                    },
                    true,
                    ["encrypt"]
                );

                return cryptoKey;

            } catch (error) {

                // 如果是HTTP环境下的crypto限制，提供降级方案
                if (error.message.includes('undefined') || error.message.includes('importKey')) {
                    return createFallbackKey(base64Key);
                }

                throw new Error('公钥导入失败: ' + error.message);
            }
        }

        // HTTP环境下的降级方案
        function createFallbackKey(base64Key) {
            console.warn('⚠️ 使用降级方案：存储原始公钥');
            return {
                type: 'fallback',
                rawKey: base64Key,
                encrypt: async function(data) {
                    // 在HTTP环境下，如果crypto不可用，使用纯文本
                    console.warn('⚠️ 加密功能不可用，使用纯文本传输');
                    const encoder = new TextEncoder();
                    const encoded = encoder.encode(data);
                    return arrayBufferToBase64(encoded.buffer);
                }
            };
        }

        async function encryptPassword(password) {
            if (!cachedPublicKey) {
                throw new Error('公钥未初始化');
            }

            try {
                // 如果是降级方案
                if (cachedPublicKey.type === 'fallback') {
                    return await cachedPublicKey.encrypt(password);
                }

                const encoder = new TextEncoder();
                const data = encoder.encode(password);

                // 获取可用的crypto API
                const crypto = window.crypto || window.msCrypto;
                const subtle = crypto.subtle || crypto.webkitSubtle;

                // 使用RSA-OAEP加密
                const encryptedBuffer = await subtle.encrypt(
                    {
                        name: "RSA-OAEP"
                    },
                    cachedPublicKey,
                    data
                );

                // 转换为Base64字符串
                return arrayBufferToBase64(encryptedBuffer);

            } catch (error) {
                // 如果加密失败，尝试降级为纯文本
                if (confirm('加密功能不可用，是否使用纯文本传输？（不安全）')) {
                    console.warn('⚠️ 使用纯文本传输密码');
                    return password; // 直接返回明文
                } else {
                    throw new Error('密码加密失败: ' + error.message);
                }
            }
        }

        function fetchAndStorePublicKey() {
            return fetch(getContextPath() + '/argus/getPublicKey', {
                method: 'GET',
                credentials: 'include'
            })
                .then(response => {
                    if (!response.ok) {
                        throw new Error(`获取公钥失败: ${response.status}`);
                    }

                    const publicKeyBase64 = response.headers.get('argus-public-key');
                    if (!publicKeyBase64) {
                        throw new Error('响应头中未找到公钥');
                    }

                    return importPublicKey(publicKeyBase64);
                })
                .then(key => {
                    cachedPublicKey = key;
                    if (key.type === 'fallback') {
                        console.warn('⚠️ 使用降级加密方案');
                    }
                    return key;
                })
                .catch(error => {
                    console.error('❌ 获取公钥失败:', error);
                    throw error;
                });
        }

        // 页面加载时检查环境
        document.addEventListener('DOMContentLoaded', function() {
            const isSecure = window.isSecureContext;
            const isLocal = window.location.hostname === 'localhost' ||
                window.location.hostname === '127.0.0.1';

            if (!isSecure && !isLocal) {
                console.warn('⚠️ 当前使用HTTP协议，加密功能可能受限');
                showHttpWarning();
            }
        });

        // 显示HTTP警告
        function showHttpWarning() {
            // 在实际应用中可以显示友好的提示
            console.warn('建议使用HTTPS协议以获得更好的安全性');

            // 示例：在页面顶部显示警告
            const warningDiv = document.createElement('div');
            warningDiv.style.cssText = `
        background: #fff3cd;
        border: 1px solid #ffeaa7;
        color: #856404;
        padding: 10px;
        text-align: center;
        font-family: Arial, sans-serif;
    `;
            warningDiv.innerHTML = '⚠️ 当前使用HTTP连接，建议使用HTTPS以获得更好的安全性';
            document.body.insertBefore(warningDiv, document.body.firstChild);
        }

         // ArrayBuffer转Base64
        function arrayBufferToBase64(buffer) {
            const bytes = new Uint8Array(buffer);
            let binary = '';
            for (let i = 0; i < bytes.byteLength; i++) {
                binary += String.fromCharCode(bytes[i]);
            }
            return btoa(binary);
        }

        async function handleLogin() {
            // 第一步：确保公钥已加载
            await fetchAndStorePublicKey();

            const username = usernameInput.value.trim();
            const password = passwordInput.value.trim();

            // 第二步：加密密码
            const encryptedPassword = await encryptPassword(password);

            loginText.textContent = '登录中...';
            loginSpinner.style.display = 'inline-block';
            loginBtn.disabled = true;
            loginMessage.textContent = '';
            loginMessage.style.display = 'none';

            fetch(getContextPath() + '/argus/login', {
                method: 'POST',
                headers: {
                    'username': username,
                    'password': encryptedPassword
                }
            })
                .then(response => {
                    if (response.status === 200) {
                        const token = response.headers.get('argus-token');
                        const expireTime = response.headers.get('argus-token-expire-time');
                        if (token && expireTime) {
                            authToken = token;
                            const expiry = parseInt(expireTime);
                            localStorage.setItem('argus-token', token);
                            localStorage.setItem('argus-token-expiry', expiry.toString());
                            localStorage.setItem('argus-username', username);
                            startTokenTimer(expiry - new Date().getTime());
                            currentUser = username;
                            if (userHost) userHost.textContent = `argus@${currentUser}`;
                            showTerminal();
                            tokenInfo.style.display = 'flex';
                            if (tokenInterval) clearInterval(tokenInterval);
                            updateTokenExpiryDisplay(expiry);
                            connectWebSocket();
                            document.getElementById("commandInput").focus();
                        } else {
                            throw new Error('用户名或密码错误');
                        }
                    } else {
                        throw new Error('登录失败，状态码: ' + response.status);
                    }
                })
                .catch(error => {
                    showLoginMessage(error.message, 'error');
                })
                .finally(() => {
                    loginText.textContent = '登录';
                    loginSpinner.style.display = 'none';
                    loginBtn.disabled = false;
                });
        }

        function validateToken(callback) {
            if (!authToken) return callback(false);
            fetch(getContextPath() + '/argus/validateToken', {
                method: 'GET',
                headers: { 'argus-token': authToken }
            }).then(r => callback(r.status === 200)).catch(() => callback(false));
        }

        function connectWebSocket() {
            if (!authToken) return;
            validateToken(valid => {
                if (!valid) {
                    addOutput('身份验证失败，无法连接', 'error');
                    setTimeout(logout, 1500);
                    return;
                }
                statusIndicator.classList.remove('connected', 'disconnected');
                statusIndicator.classList.add('connecting');
                statusText.textContent = '连接中...';
                const wsUrl = `${getWebSocketUrl()}?argus-token=${encodeURIComponent(authToken)}`;
                websocket = new WebSocket(wsUrl);

                websocket.onopen = () => {
                    isConnected = true;
                    isReconnecting = false;
                    reconnectAttempts = 0;
                    statusIndicator.classList.remove('connecting', 'disconnected');
                    statusIndicator.classList.add('connected');
                    statusText.textContent = '已连接';
                    addOutput("已连接 argus", 'success');
                    addOutput("输入 'help' 查看命令列表 。", 'info');
                    addOutput("快捷键：ctrl+s 清除所有监听， ctrl+e 关闭连接，ctrl+q 登出。 ", 'info');
                    // 连接成功后，创建新的输入行
                    addCommandInputLine();
                };

                // 处理消息
                websocket.onmessage = (event) => {
                    try {
                        const message = event.data;
                        // 仅处理含 #ouputconcat# 的消息
                        if (!message.includes('#ouputconcat#')) {
                            addOutput(message);
                            addCommandInputLine();
                            return;
                        }
                        // 提取 code 和 data
                        const codeMatch = message.match(/^code=(\d+)#ouputconcat#data=(.*)/s);
                        if (!codeMatch) {
                            addOutput('协议错误：无法解析消息', 'error');
                            return;
                        }
                        const code = parseInt(codeMatch[1], 10);
                        const data = codeMatch[2];

                        // 获取当前时间 HH:MM:SS
                        const now = new Date();
                        const timeStr = now.getHours().toString().padStart(2, '0') +
                            ':' + now.getMinutes().toString().padStart(2, '0') +
                            ':' + now.getSeconds().toString().padStart(2, '0');

                        if (code === 1) {
                            // 成功响应
                            const timeDiv = document.createElement('div');
                            timeDiv.className = 'output response time-stamp';
                            timeDiv.style.color = '#00b8ff';
                            timeDiv.style.opacity = '0.9';
                            timeDiv.style.fontWeight = '500';
                            timeDiv.style.marginBottom = '4px';
                            timeDiv.style.userSelect = 'none';
                            timeDiv.textContent = timeStr;
                            commandHistory.appendChild(timeDiv);

                            // 使用新函数处理内容（含复制）
                            const contentDiv = renderCopyableContent(data);
                            commandHistory.appendChild(contentDiv);
                            scrollToBottom();
                            addCommandInputLine();
                        } else {
                            // 错误响应：同样支持复制
                            const timeDiv = document.createElement('div');
                            timeDiv.className = 'output error time-stamp';
                            timeDiv.style.color = '#ff5f56';
                            timeDiv.style.opacity = '0.9';
                            timeDiv.style.fontWeight = '500';
                            timeDiv.style.marginBottom = '4px';
                            timeDiv.style.userSelect = 'none';
                            timeDiv.textContent = timeStr;
                            commandHistory.appendChild(timeDiv);

                            // 关键：错误内容也用 renderCopyableContent 处理！
                            const errorDiv = renderCopyableContent(data);
                            errorDiv.style.color = '#ff5f56'; // 保持错误红色
                            commandHistory.appendChild(errorDiv);
                            scrollToBottom();
                            addCommandInputLine();
                        }
                    } catch (e) {
                        addOutput(`解析消息失败: ${e.message}`, 'error');
                    }
                };
                websocket.onclose = (event) => {
                    isConnected = false;
                    statusIndicator.classList.remove('connecting', 'connected');
                    statusIndicator.classList.add('disconnected');
                    statusText.textContent = '未连接';
                    if (event.wasClean && event.code === 1000) {
                        addOutput(`已断开 argus 连接: ${event.code} ${event.reason || ''}`, 'info');
                    } else if (event.code === 1001) {
                        addOutput(`argus 断开: ${event.code} ${event.reason || ''}`, 'error');
                        attemptReconnect();
                    } else {
                        addOutput('连接 argus 异常断开，正在重试...', 'error');
                        attemptReconnect();
                    }
                    // 连接断开后，创建新的输入行
                    addCommandInputLine();
                };

                websocket.onerror = (err) => {
                    console.error('WebSocket错误:', err);
                    addOutput('连接 argus 错误', 'error');
                };
            });
        }

        function renderCopyableContent(data, defaultColor = '#00ffc8') {
            const outputDiv = document.createElement('div');
            outputDiv.className = 'output response content';
            outputDiv.style.whiteSpace = 'pre-wrap';
            outputDiv.style.wordBreak = 'break-all';
            outputDiv.style.fontFamily = 'Fira Code, monospace';
            outputDiv.style.lineHeight = '1.5';

            const START_TAG = '#copystart#';
            const END_TAG = '#copyend#';
            let index = 0;
            let lastIndex = 0;

            while (index < data.length) {
                const startIdx = data.indexOf(START_TAG, index);
                if (startIdx === -1) break;
                if (startIdx > lastIndex) {
                    const text = data.slice(lastIndex, startIdx);
                    outputDiv.appendChild(document.createTextNode(text));
                }
                const endIdx = data.indexOf(END_TAG, startIdx + START_TAG.length);
                if (endIdx === -1) {
                    outputDiv.appendChild(document.createTextNode(data.slice(startIdx)));
                    break;
                }
                const innerContent = data.slice(startIdx + START_TAG.length, endIdx);
                const hasValidContent = innerContent.trim() !== '';
                if (hasValidContent) {
                    const copyText = document.createElement('span');
                    copyText.textContent = innerContent;
                    copyText.style.cssText = `
                display: inline;
                color: ${defaultColor};
                font-weight: 500;
                background: ${hexToRgba(defaultColor, 0.1)};
                padding: 2px 4px;
                border-radius: 4px;
                margin: 0 2px;
                border: 1px solid ${hexToRgba(defaultColor, 0.1)};
                white-space: pre;
                line-height: 1.4;
                cursor: pointer;
                transition: all 0.2s ease;
                position: relative;
            `;

                    const tooltip = document.createElement('span');
                    tooltip.textContent = '点击即可复制';
                    tooltip.style.cssText = `
                position: fixed;
                background: rgba(0, 0, 0, 0.8);
                color: ${defaultColor};
                padding: 4px 8px;
                border-radius: 4px;
                font-size: 12px;
                white-space: nowrap;
                opacity: 0;
                transition: opacity 0.2s ease;
                pointer-events: none;
                z-index: 1000;
                top: 0;
                left: 0;
            `;
                    document.body.appendChild(tooltip);

                    copyText.addEventListener('mousemove', (e) => {
                        tooltip.style.top = (e.clientY - 10) + 'px';
                        tooltip.style.left = (e.clientX + 15) + 'px';
                    });
                    copyText.addEventListener('mouseenter', (e) => {
                        copyText.style.background = hexToRgba(defaultColor, 0.2);
                        copyText.style.boxShadow = `0 0 8px ${hexToRgba(defaultColor, 0.3)}`;
                        tooltip.style.top = (e.clientY - 10) + 'px';
                        tooltip.style.left = (e.clientX + 15) + 'px';
                        tooltip.style.opacity = '1';
                    });
                    copyText.addEventListener('mouseleave', () => {
                        copyText.style.background = hexToRgba(defaultColor, 0.1);
                        copyText.style.boxShadow = 'none';
                        tooltip.style.opacity = '0';
                    });
                    copyText.addEventListener('click', (e) => {
                        e.stopPropagation();
                        const showTooltipMessage = (message) => {
                            const originalText = tooltip.textContent;
                            tooltip.textContent = message;
                            tooltip.style.opacity = '1';
                            setTimeout(() => {
                                tooltip.textContent = originalText;
                                tooltip.style.opacity = '0';
                            }, 1500);
                        };

                        if (navigator.clipboard && navigator.clipboard.writeText) {
                            navigator.clipboard.writeText(innerContent).then(() => {
                                showTooltipMessage('✓ 已复制');
                            }).catch(() => fallbackCopyToClipboard());
                        } else {
                            fallbackCopyToClipboard();
                        }

                        function fallbackCopyToClipboard() {
                            const textarea = document.createElement('textarea');
                            textarea.value = innerContent;
                            textarea.style.position = 'fixed';
                            textarea.style.top = '0';
                            textarea.style.left = '0';
                            textarea.style.opacity = '0';
                            document.body.appendChild(textarea);
                            textarea.select();
                            textarea.setSelectionRange(0, 99999);
                            try {
                                const successful = document.execCommand('copy');
                                if (successful) {
                                    showTooltipMessage('✓ 已复制');
                                } else {
                                    throw new Error('execCommand 复制失败');
                                }
                            } catch (err) {
                                console.error('降级复制方案也失败:', err);
                                showTooltipMessage('✗ 复制失败');
                            } finally {
                                document.body.removeChild(textarea);
                            }
                        }
                    });
                    outputDiv.appendChild(copyText);
                }
                lastIndex = endIdx + END_TAG.length;
                index = lastIndex;
            }

            if (lastIndex < data.length) {
                const remaining = data.slice(lastIndex);
                const coloredText = parseColorTags(remaining);
                const tempDiv = document.createElement('div');
                tempDiv.innerHTML = coloredText;
                while (tempDiv.firstChild) {
                    outputDiv.appendChild(tempDiv.firstChild);
                }
            }

            return outputDiv;
        }

        // 辅助函数：HEX 转 RGBA
        function hexToRgba(hex, alpha) {
            if (!/^#[0-9A-Fa-f]{6}$/.test(hex)) return `rgba(0, 255, 200, ${alpha})`;
            const r = parseInt(hex.slice(1, 3), 16);
            const g = parseInt(hex.slice(3, 5), 16);
            const b = parseInt(hex.slice(5, 7), 16);
            return `rgba(${r}, ${g}, ${b}, ${alpha})`;
        }

        function attemptReconnect() {
            if (reconnectAttempts >= MAX_RECONNECT_ATTEMPTS || isReconnecting) {
                addOutput('重连失败次数过多，正在跳转至登录页面...', 'error');
                setTimeout(logout, 1500);
                return;
            }
            isReconnecting = true;
            reconnectAttempts++;
            const delay = BASE_RECONNECT_DELAY * Math.pow(2, reconnectAttempts - 1);
            addOutput(`第 ${reconnectAttempts}/${MAX_RECONNECT_ATTEMPTS} 次重连尝试...`, 'info');
            setTimeout(() => {
                isReconnecting = false;
                connectWebSocket();
            }, delay);
        }

        function sendCommand(command) {
            if (!websocket || websocket.readyState !== WebSocket.OPEN) {
                addOutput('未连接，请先使用 connect 连接', 'error');
                // 本地反馈：创建新输入行
                addCommandInputLine();
                return false;
            }
            try {
                websocket.send(command);
                // 发送成功后，立即移除当前输入行
                const currentInput = document.getElementById('commandInput');
                if (currentInput && currentInput.closest('.command-line')) {
                    currentInput.closest('.command-line').remove();
                }
                return true;
            } catch (error) {
                addOutput(error.message, 'error');
                // 创建新输入行
                addCommandInputLine();
                return false;
            }
        }

        function showLoginMessage(message, type = 'response') {
            loginMessage.textContent = message;
            loginMessage.className = `login-message ${type}`;
            loginMessage.style.display = 'block';
        }

        function startTokenTimer(expireTime) {
            if (tokenTimer) clearTimeout(tokenTimer);
            tokenTimer = setTimeout(() => {
                addOutput('登录已过期，请重新登录', 'error');
                logout();
            }, expireTime);
        }

        function updateTokenExpiryDisplay(expiry) {
            if (tokenInterval) clearInterval(tokenInterval);
            const update = () => {
                const now = Date.now();
                const remaining = expiry - now;
                if (remaining <= 0) {
                    tokenExpiryElement.textContent = '已过期';
                    return;
                }
                const minutes = Math.floor(remaining / 60000);
                const seconds = Math.floor((remaining % 60000) / 1000);
                tokenExpiryElement.textContent = `Token剩余: ${minutes}分${seconds}秒`;
            };
            update();
            tokenInterval = setInterval(update, 1000);
        }

        function showTerminal() {
            loginContainer.style.display = 'none';
            terminalOutput.style.display = 'flex';
            if (!currentUser) {
                const storedUsername = localStorage.getItem('argus-username');
                if (storedUsername) {
                    currentUser = storedUsername;
                    // 同时更新界面上已存在的提示符（如果有的话）
                    const userHost = document.querySelector('.user-host');
                    if (userHost) {
                        userHost.textContent = `argus@${currentUser}`;
                    }
                }
            }

            // 现在创建输入行，currentUser 已经是正确的值
            addCommandInputLine();
        }

        function logout() {
            if (websocket) websocket.close();
            authToken = null;
            localStorage.removeItem('argus-token');
            localStorage.removeItem('argus-token-expiry');
            localStorage.removeItem('argus-username');
            if (tokenTimer) clearTimeout(tokenTimer);
            if (tokenInterval) clearInterval(tokenInterval);
            loginContainer.style.display = 'flex';
            terminalOutput.style.display = 'none';
            tokenInfo.style.display = 'none';
            passwordInput.value = '';
        }

        terminalOutput.addEventListener('click', function(e) {
            const selection = window.getSelection();
            const input = document.getElementById('commandInput');
            if (selection.toString().length > 0) return;
            if (e.target === input || input.contains(e.target)) return;
            if (e.target.closest('.prompt') || e.target === document.getElementById('outputContainer')) {
                input.focus();
            }
        });

        function addOutput(text, type = 'response') {
            const div = document.createElement('div');
            div.className = `output ${type}`;
            div.textContent = text;
            commandHistory.appendChild(div);
            scrollToBottom();
        }

        function parseColorTags(text) {
            if (!text || typeof text !== 'string') return text;

            return text.replace(/\[#([0-9A-Fa-f]{6})\]([\s\S]*?)\[\/\]/g, (match, color, content) => {
                // 转义 HTML 特殊字符（防 XSS）
                const escapedContent = escapeHtml(content);

                // 可选：将 \n 转为 <br> 实现换行显示
                const finalContent = escapedContent.replace(/\n/g, '<br>');

                return `<span style="
            color: #${color};
            font-weight: 600;
            text-shadow: none;
            box-shadow: none;
            border: none;
            background: none;
            padding: 0;
            margin: 0;
            white-space: pre-line; /* 保留换行 */
        ">${finalContent}</span>`;
            });
        }

        // 安全转义 HTML
        function escapeHtml(text) {
            const div = document.createElement('div');
            div.textContent = text;
            return div.innerHTML;
        }

        function addCommandInputLine() {
            const container = document.getElementById('outputContainer');
            const oldInput = document.getElementById('commandInput');
            if (oldInput && oldInput.closest('.command-line')) {
                oldInput.closest('.command-line').remove();
            }
            // 从 localStorage 获取用户名
            let displayUsername = currentUser; // 先尝试用全局变量
            if (!displayUsername) {
                displayUsername = localStorage.getItem('argus-username') || ''; // 如果全局变量为空，从 localStorage 读取，再不行就用 'guest'
            }
            const line = document.createElement('div');
            line.className = 'command-line';
            line.innerHTML = `
                <span class="prompt">
                    <span class="user-host">argus@${displayUsername}</span> %
                </span>
                <div class="input-line">
                    <div class="command-input-wrapper">
                        <input type="text" class="command-input" id="commandInput" autocomplete="off">
                    </div>
                </div>
            `;
            container.appendChild(line);
            const input = document.getElementById('commandInput');
            input.addEventListener('keydown', function(e) {
                const isCtrlOrMeta = e.ctrlKey || e.metaKey;

                // 如果按下了 Ctrl 或 Meta（Cmd on Mac）
                if (isCtrlOrMeta && !e.altKey) {
                    const key = e.key.toLowerCase();

                    // 白名单：允许系统编辑快捷键
                    if (['a', 'c', 'v', 'x'].includes(key)) {
                        // 允许浏览器默认行为（复制/粘贴/剪切）
                        return;
                    }

                    if (key === 's') {
                        e.preventDefault();
                        handleCommand('reset');
                        return;
                    }
                    // 自定义快捷键：Ctrl+E → exit
                    if (key === 'e') {
                        e.preventDefault();
                        handleCommand('exit');
                        return;
                    }

                    // 自定义快捷键：Ctrl+Q → 带提示登出
                    if (key === 'q') {
                        e.preventDefault();
                        addOutput("正在登出...", "info");
                        setTimeout(logout, 1000);
                        return;
                    }

                    // 其他所有 Ctrl/Meta 组合：阻止默认行为（包括 Ctrl+R, Ctrl+T, F5 等）
                    e.preventDefault();
                    e.stopPropagation();
                    return;
                }
                if (e.key === 'Enter') {
                    e.preventDefault();
                    const command = input.value.trim();
                    if (command) {
                        commands.push(command);
                        commandIndex = commands.length;
                        // 只有当命令不是 'clear' 时，才输出命令历史
                        if (command.toLowerCase() !== 'clear') {
                            // 在这里也使用动态获取的用户名
                            let cmdDisplayUser = currentUser;
                            if (!cmdDisplayUser) {
                                cmdDisplayUser = localStorage.getItem('argus-username') || 'guest';
                            }
                            addOutput(`argus@${cmdDisplayUser}% ${command}`, 'command');
                        }
                        handleCommand(command);
                    }
                } else if (e.key === 'ArrowUp') {
                    e.preventDefault();
                    if (commands.length > 0 && commandIndex > 0) {
                        commandIndex--;
                        input.value = commands[commandIndex];
                    }
                } else if (e.key === 'ArrowDown') {
                    e.preventDefault();
                    if (commandIndex < commands.length - 1) {
                        commandIndex++;
                        input.value = commands[commandIndex];
                    } else {
                        commandIndex = commands.length;
                        input.value = '';
                    }
                }
            });
            input.focus();
            scrollToBottom();
        }

        function handleCommand(command) {
            switch (command.toLowerCase()) {
                case 'clear':
                    commandHistory.innerHTML = '';
                    addCommandInputLine();
                    break;
                case 'connect':
                    if (!isConnected) connectWebSocket();
                    else addOutput('已连接', 'error');
                    addCommandInputLine();
                    break;
                case 'exit':
                    if (websocket) websocket.close();
                    addCommandInputLine();
                    break;
                case 'logout':
                    addOutput('正在登出...', 'info');
                    setTimeout(logout, 1500);
                    break;
                default:
                    sendCommand(command);
                    break;
            }
        }
    });
</script>
</body>
</html>